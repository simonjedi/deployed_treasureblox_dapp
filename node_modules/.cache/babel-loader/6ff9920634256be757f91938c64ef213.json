{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.JSONRPC = void 0;\n\nconst utils = require(\"../utils\");\n\nconst meterifyResult = function (result) {\n  // tricks for compatible with original web3 instance\n  // non-objects or non-arrays doesn't need isMeterified property since meterify just overwritten 3 formatters\n  // which all accept object as input\n  if (utils.isArray(result)) {\n    result = result.map(item => {\n      Object.defineProperty(item, 'isMeterified', {\n        get: () => true\n      });\n      return item;\n    });\n  } else if (utils.isObject(result)) {\n    Object.defineProperty(result, 'isMeterified', {\n      get: () => true\n    });\n  }\n\n  return result;\n};\n\nclass JSONRPC {\n  constructor(payload) {\n    this.id = payload.id;\n    this.method = payload.method;\n    this.params = payload.params;\n  }\n\n  makeResult(result) {\n    return {\n      id: this.id,\n      jsonrpc: '2.0',\n      result: meterifyResult(result)\n    };\n  }\n\n  makeError(message) {\n    return {\n      id: this.id,\n      jsonrpc: '2.0',\n      error: {\n        message\n      }\n    };\n  }\n\n  makeSubResult(result) {\n    return {\n      id: this.id,\n      jsonrpc: '2.0',\n      method: this.method,\n      params: {\n        result: {\n          data: meterifyResult(result)\n        },\n        subscription: this.id\n      }\n    };\n  }\n\n  makeSubError(error) {\n    return {\n      id: this.id,\n      jsonrpc: '2.0',\n      method: this.method,\n      params: {\n        result: {\n          error\n        },\n        subscription: this.id\n      }\n    };\n  }\n\n}\n\nexports.JSONRPC = JSONRPC;","map":{"version":3,"sources":["../../src/provider/json-rpc.ts"],"names":[],"mappings":"AAAA;;;;;;;AACA,MAAA,KAAA,GAAA,OAAA,CAAA,UAAA,CAAA;;AAgCA,MAAM,cAAc,GAAG,UAAS,MAAT,EAAoB;AACvC;AACA;AACA;AACA,MAAI,KAAK,CAAC,OAAN,CAAc,MAAd,CAAJ,EAA2B;AACvB,IAAA,MAAM,GAAG,MAAM,CAAC,GAAP,CAAY,IAAD,IAAc;AAC9B,MAAA,MAAM,CAAC,cAAP,CAAsB,IAAtB,EAA4B,cAA5B,EAA4C;AAAE,QAAA,GAAG,EAAE,MAAM;AAAb,OAA5C;AACA,aAAO,IAAP;AACH,KAHQ,CAAT;AAIH,GALD,MAKO,IAAI,KAAK,CAAC,QAAN,CAAe,MAAf,CAAJ,EAA4B;AAC/B,IAAA,MAAM,CAAC,cAAP,CAAsB,MAAtB,EAA8B,cAA9B,EAA8C;AAAE,MAAA,GAAG,EAAE,MAAM;AAAb,KAA9C;AACH;;AACD,SAAO,MAAP;AACH,CAbD;;AAeA,MAAa,OAAb,CAAoB;AAKhB,EAAA,WAAA,CAAY,OAAZ,EAA+B;AAC3B,SAAK,EAAL,GAAU,OAAO,CAAC,EAAlB;AACA,SAAK,MAAL,GAAc,OAAO,CAAC,MAAtB;AACA,SAAK,MAAL,GAAc,OAAO,CAAC,MAAtB;AACH;;AAEM,EAAA,UAAU,CAAC,MAAD,EAAY;AACzB,WAAO;AACH,MAAA,EAAE,EAAE,KAAK,EADN;AAEH,MAAA,OAAO,EAAE,KAFN;AAGH,MAAA,MAAM,EAAE,cAAc,CAAC,MAAD;AAHnB,KAAP;AAKH;;AAEM,EAAA,SAAS,CAAC,OAAD,EAAgB;AAC5B,WAAO;AACH,MAAA,EAAE,EAAE,KAAK,EADN;AAEH,MAAA,OAAO,EAAE,KAFN;AAGH,MAAA,KAAK,EAAE;AACH,QAAA;AADG;AAHJ,KAAP;AAOH;;AAEM,EAAA,aAAa,CAAC,MAAD,EAAY;AAC5B,WAAO;AACH,MAAA,EAAE,EAAE,KAAK,EADN;AAEH,MAAA,OAAO,EAAE,KAFN;AAGH,MAAA,MAAM,EAAE,KAAK,MAHV;AAIH,MAAA,MAAM,EAAE;AACJ,QAAA,MAAM,EAAE;AACJ,UAAA,IAAI,EAAE,cAAc,CAAC,MAAD;AADhB,SADJ;AAIJ,QAAA,YAAY,EAAE,KAAK;AAJf;AAJL,KAAP;AAWH;;AAEM,EAAA,YAAY,CAAC,KAAD,EAAW;AAC1B,WAAO;AACH,MAAA,EAAE,EAAE,KAAK,EADN;AAEH,MAAA,OAAO,EAAE,KAFN;AAGH,MAAA,MAAM,EAAE,KAAK,MAHV;AAIH,MAAA,MAAM,EAAE;AACJ,QAAA,MAAM,EAAE;AACJ,UAAA;AADI,SADJ;AAIJ,QAAA,YAAY,EAAE,KAAK;AAJf;AAJL,KAAP;AAWH;;AAvDe;;AAApB,OAAA,CAAA,OAAA,GAAA,OAAA","sourceRoot":"","sourcesContent":["'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.JSONRPC = void 0;\nconst utils = require(\"../utils\");\nconst meterifyResult = function (result) {\n    // tricks for compatible with original web3 instance\n    // non-objects or non-arrays doesn't need isMeterified property since meterify just overwritten 3 formatters\n    // which all accept object as input\n    if (utils.isArray(result)) {\n        result = result.map((item) => {\n            Object.defineProperty(item, 'isMeterified', { get: () => true });\n            return item;\n        });\n    }\n    else if (utils.isObject(result)) {\n        Object.defineProperty(result, 'isMeterified', { get: () => true });\n    }\n    return result;\n};\nclass JSONRPC {\n    constructor(payload) {\n        this.id = payload.id;\n        this.method = payload.method;\n        this.params = payload.params;\n    }\n    makeResult(result) {\n        return {\n            id: this.id,\n            jsonrpc: '2.0',\n            result: meterifyResult(result),\n        };\n    }\n    makeError(message) {\n        return {\n            id: this.id,\n            jsonrpc: '2.0',\n            error: {\n                message,\n            },\n        };\n    }\n    makeSubResult(result) {\n        return {\n            id: this.id,\n            jsonrpc: '2.0',\n            method: this.method,\n            params: {\n                result: {\n                    data: meterifyResult(result),\n                },\n                subscription: this.id,\n            },\n        };\n    }\n    makeSubError(error) {\n        return {\n            id: this.id,\n            jsonrpc: '2.0',\n            method: this.method,\n            params: {\n                result: {\n                    error,\n                },\n                subscription: this.id,\n            },\n        };\n    }\n}\nexports.JSONRPC = JSONRPC;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoianNvbi1ycGMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcHJvdmlkZXIvanNvbi1ycGMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFBOzs7QUFDWixrQ0FBaUM7QUFnQ2pDLE1BQU0sY0FBYyxHQUFHLFVBQVMsTUFBVztJQUN2QyxvREFBb0Q7SUFDcEQsNEdBQTRHO0lBQzVHLG1DQUFtQztJQUNuQyxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDdkIsTUFBTSxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRTtZQUM5QixNQUFNLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRSxjQUFjLEVBQUUsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQTtZQUNoRSxPQUFPLElBQUksQ0FBQTtRQUNmLENBQUMsQ0FBQyxDQUFBO0tBQ0w7U0FBTSxJQUFJLEtBQUssQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUU7UUFDL0IsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsY0FBYyxFQUFFLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUE7S0FDckU7SUFDRCxPQUFPLE1BQU0sQ0FBQTtBQUNqQixDQUFDLENBQUE7QUFFRCxNQUFhLE9BQU87SUFLaEIsWUFBWSxPQUFtQjtRQUMzQixJQUFJLENBQUMsRUFBRSxHQUFHLE9BQU8sQ0FBQyxFQUFFLENBQUE7UUFDcEIsSUFBSSxDQUFDLE1BQU0sR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFBO1FBQzVCLElBQUksQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQTtJQUNoQyxDQUFDO0lBRU0sVUFBVSxDQUFDLE1BQVc7UUFDekIsT0FBTztZQUNILEVBQUUsRUFBRSxJQUFJLENBQUMsRUFBRTtZQUNYLE9BQU8sRUFBRSxLQUFLO1lBQ2QsTUFBTSxFQUFFLGNBQWMsQ0FBQyxNQUFNLENBQUM7U0FDakMsQ0FBQTtJQUNMLENBQUM7SUFFTSxTQUFTLENBQUMsT0FBZTtRQUM1QixPQUFPO1lBQ0gsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO1lBQ1gsT0FBTyxFQUFFLEtBQUs7WUFDZCxLQUFLLEVBQUU7Z0JBQ0gsT0FBTzthQUNWO1NBQ0osQ0FBQTtJQUNMLENBQUM7SUFFTSxhQUFhLENBQUMsTUFBVztRQUM1QixPQUFPO1lBQ0gsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO1lBQ1gsT0FBTyxFQUFFLEtBQUs7WUFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU07WUFDbkIsTUFBTSxFQUFFO2dCQUNKLE1BQU0sRUFBRTtvQkFDSixJQUFJLEVBQUUsY0FBYyxDQUFDLE1BQU0sQ0FBQztpQkFDL0I7Z0JBQ0QsWUFBWSxFQUFFLElBQUksQ0FBQyxFQUFFO2FBQ3hCO1NBQ0osQ0FBQTtJQUNMLENBQUM7SUFFTSxZQUFZLENBQUMsS0FBVTtRQUMxQixPQUFPO1lBQ0gsRUFBRSxFQUFFLElBQUksQ0FBQyxFQUFFO1lBQ1gsT0FBTyxFQUFFLEtBQUs7WUFDZCxNQUFNLEVBQUUsSUFBSSxDQUFDLE1BQU07WUFDbkIsTUFBTSxFQUFFO2dCQUNKLE1BQU0sRUFBRTtvQkFDSixLQUFLO2lCQUNSO2dCQUNELFlBQVksRUFBRSxJQUFJLENBQUMsRUFBRTthQUN4QjtTQUNKLENBQUE7SUFDTCxDQUFDO0NBRUo7QUF6REQsMEJBeURDIn0="]},"metadata":{},"sourceType":"script"}