{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.HTTP = exports.Method = void 0;\n\nconst XHR2 = require('xhr2');\n\nvar Method;\n\n(function (Method) {\n  Method[Method[\"GET\"] = 0] = \"GET\";\n  Method[Method[\"POST\"] = 1] = \"POST\";\n})(Method = exports.Method || (exports.Method = {}));\n\nconst post = function (url, body, timeout = 0) {\n  return request(Method.POST, url, body, timeout);\n};\n\nconst get = function (url, timeout = 0) {\n  return request(Method.GET, url, null, timeout);\n};\n\nexports.HTTP = {\n  get,\n  post\n};\n\nconst request = function (method, url, body, timeout) {\n  return new Promise((resolve, reject) => {\n    const xhr = new XHR2();\n    xhr.timeout = timeout;\n    xhr.open(Method[method], url);\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState === 4) {\n        const res = {\n          Code: xhr.status,\n          Body: null\n        };\n\n        if (xhr.status === 200) {\n          try {\n            res.Body = JSON.parse(xhr.responseText);\n          } catch (e) {\n            return reject(new Error(`[meter-provider]Error parsing the response: ${e.message}`));\n          }\n        } else if (xhr.responseText && xhr.responseText.length) {\n          res.Body = xhr.responseText;\n        }\n\n        return resolve(res);\n      }\n    };\n\n    xhr.ontimeout = () => {\n      return reject(new Error(`[meter-provider]Time out for whatever reason, check your provider`));\n    };\n\n    try {\n      xhr.send(method === Method.POST ? JSON.stringify(body) : null);\n    } catch (e) {\n      return reject(new Error(`[meter-provider]Connect error: ${e.message}`));\n    }\n  });\n};","map":{"version":3,"sources":["../../src/provider/simple-http.ts"],"names":[],"mappings":"AAAA;;;;;;;AACA,MAAM,IAAI,GAAG,OAAO,CAAC,MAAD,CAApB;;AAQA,IAAY,MAAZ;;AAAA,CAAA,UAAY,MAAZ,EAAkB;AACd,EAAA,MAAA,CAAA,MAAA,CAAA,KAAA,CAAA,GAAA,CAAA,CAAA,GAAA,KAAA;AACA,EAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,GAAA,CAAA,CAAA,GAAA,MAAA;AACH,CAHD,EAAY,MAAM,GAAN,OAAA,CAAA,MAAA,KAAA,OAAA,CAAA,MAAA,GAAM,EAAN,CAAZ;;AAKA,MAAM,IAAI,GAAG,UAAS,GAAT,EAAsB,IAAtB,EAAoC,OAAO,GAAE,CAA7C,EAA8C;AACvD,SAAO,OAAO,CAAC,MAAM,CAAC,IAAR,EAAc,GAAd,EAAmB,IAAnB,EAAyB,OAAzB,CAAd;AACH,CAFD;;AAIA,MAAM,GAAG,GAAG,UAAS,GAAT,EAAsB,OAAO,GAAG,CAAhC,EAAiC;AACzC,SAAO,OAAO,CAAC,MAAM,CAAC,GAAR,EAAa,GAAb,EAAkB,IAAlB,EAAwB,OAAxB,CAAd;AACH,CAFD;;AAIa,OAAA,CAAA,IAAA,GAAO;AAAC,EAAA,GAAD;AAAM,EAAA;AAAN,CAAP;;AAEb,MAAM,OAAO,GAAG,UAAS,MAAT,EAAyB,GAAzB,EAAsC,IAAtC,EAA2D,OAA3D,EAA0E;AAEtF,SAAO,IAAI,OAAJ,CAAY,CAAC,OAAD,EAAU,MAAV,KAAoB;AACnC,UAAM,GAAG,GAAG,IAAI,IAAJ,EAAZ;AACA,IAAA,GAAG,CAAC,OAAJ,GAAc,OAAd;AACA,IAAA,GAAG,CAAC,IAAJ,CAAS,MAAM,CAAC,MAAD,CAAf,EAAyB,GAAzB;;AAEA,IAAA,GAAG,CAAC,kBAAJ,GAAyB,MAAK;AAC1B,UAAI,GAAG,CAAC,UAAJ,KAAmB,CAAvB,EAA0B;AACtB,cAAM,GAAG,GAAmB;AACxB,UAAA,IAAI,EAAE,GAAG,CAAC,MADc;AAExB,UAAA,IAAI,EAAE;AAFkB,SAA5B;;AAKA,YAAI,GAAG,CAAC,MAAJ,KAAe,GAAnB,EAAwB;AACpB,cAAI;AACA,YAAA,GAAG,CAAC,IAAJ,GAAW,IAAI,CAAC,KAAL,CAAW,GAAG,CAAC,YAAf,CAAX;AACH,WAFD,CAEE,OAAO,CAAP,EAAU;AACR,mBAAO,MAAM,CAAC,IAAI,KAAJ,CAAU,+CAA+C,CAAC,CAAC,OAAO,EAAlE,CAAD,CAAb;AACH;AACJ,SAND,MAMO,IAAI,GAAG,CAAC,YAAJ,IAAoB,GAAG,CAAC,YAAJ,CAAiB,MAAzC,EAAiD;AACpD,UAAA,GAAG,CAAC,IAAJ,GAAW,GAAG,CAAC,YAAf;AACH;;AAED,eAAO,OAAO,CAAC,GAAD,CAAd;AACH;AACJ,KAnBD;;AAqBA,IAAA,GAAG,CAAC,SAAJ,GAAgB,MAAK;AACjB,aAAO,MAAM,CAAC,IAAI,KAAJ,CAAU,mEAAV,CAAD,CAAb;AACH,KAFD;;AAIA,QAAI;AACA,MAAA,GAAG,CAAC,IAAJ,CAAS,MAAM,KAAK,MAAM,CAAC,IAAlB,GAAyB,IAAI,CAAC,SAAL,CAAe,IAAf,CAAzB,GAAgD,IAAzD;AACH,KAFD,CAEE,OAAO,CAAP,EAAU;AACR,aAAO,MAAM,CAAC,IAAI,KAAJ,CAAU,kCAAkC,CAAC,CAAC,OAAO,EAArD,CAAD,CAAb;AACH;AACJ,GAnCM,CAAP;AAoCH,CAtCD","sourceRoot":"","sourcesContent":["'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HTTP = exports.Method = void 0;\nconst XHR2 = require('xhr2');\nvar Method;\n(function (Method) {\n    Method[Method[\"GET\"] = 0] = \"GET\";\n    Method[Method[\"POST\"] = 1] = \"POST\";\n})(Method = exports.Method || (exports.Method = {}));\nconst post = function (url, body, timeout = 0) {\n    return request(Method.POST, url, body, timeout);\n};\nconst get = function (url, timeout = 0) {\n    return request(Method.GET, url, null, timeout);\n};\nexports.HTTP = { get, post };\nconst request = function (method, url, body, timeout) {\n    return new Promise((resolve, reject) => {\n        const xhr = new XHR2();\n        xhr.timeout = timeout;\n        xhr.open(Method[method], url);\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState === 4) {\n                const res = {\n                    Code: xhr.status,\n                    Body: null,\n                };\n                if (xhr.status === 200) {\n                    try {\n                        res.Body = JSON.parse(xhr.responseText);\n                    }\n                    catch (e) {\n                        return reject(new Error(`[meter-provider]Error parsing the response: ${e.message}`));\n                    }\n                }\n                else if (xhr.responseText && xhr.responseText.length) {\n                    res.Body = xhr.responseText;\n                }\n                return resolve(res);\n            }\n        };\n        xhr.ontimeout = () => {\n            return reject(new Error(`[meter-provider]Time out for whatever reason, check your provider`));\n        };\n        try {\n            xhr.send(method === Method.POST ? JSON.stringify(body) : null);\n        }\n        catch (e) {\n            return reject(new Error(`[meter-provider]Connect error: ${e.message}`));\n        }\n    });\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLWh0dHAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvcHJvdmlkZXIvc2ltcGxlLWh0dHAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFBOzs7QUFDWixNQUFNLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUE7QUFRNUIsSUFBWSxNQUdYO0FBSEQsV0FBWSxNQUFNO0lBQ2QsaUNBQU0sQ0FBQTtJQUNOLG1DQUFJLENBQUE7QUFDUixDQUFDLEVBSFcsTUFBTSxHQUFOLGNBQU0sS0FBTixjQUFNLFFBR2pCO0FBRUQsTUFBTSxJQUFJLEdBQUcsVUFBUyxHQUFXLEVBQUUsSUFBWSxFQUFFLE9BQU8sR0FBRSxDQUFDO0lBQ3ZELE9BQU8sT0FBTyxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxPQUFPLENBQUMsQ0FBQTtBQUNuRCxDQUFDLENBQUE7QUFFRCxNQUFNLEdBQUcsR0FBRyxVQUFTLEdBQVcsRUFBRSxPQUFPLEdBQUcsQ0FBQztJQUN6QyxPQUFPLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUE7QUFDbEQsQ0FBQyxDQUFBO0FBRVksUUFBQSxJQUFJLEdBQUcsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUE7QUFFL0IsTUFBTSxPQUFPLEdBQUcsVUFBUyxNQUFjLEVBQUUsR0FBVyxFQUFFLElBQW1CLEVBQUUsT0FBZTtJQUV0RixPQUFPLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxFQUFFO1FBQ25DLE1BQU0sR0FBRyxHQUFHLElBQUksSUFBSSxFQUFFLENBQUE7UUFDdEIsR0FBRyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUE7UUFDckIsR0FBRyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUE7UUFFN0IsR0FBRyxDQUFDLGtCQUFrQixHQUFHLEdBQUcsRUFBRTtZQUMxQixJQUFJLEdBQUcsQ0FBQyxVQUFVLEtBQUssQ0FBQyxFQUFFO2dCQUN0QixNQUFNLEdBQUcsR0FBbUI7b0JBQ3hCLElBQUksRUFBRSxHQUFHLENBQUMsTUFBZ0I7b0JBQzFCLElBQUksRUFBRSxJQUFJO2lCQUNiLENBQUE7Z0JBRUQsSUFBSSxHQUFHLENBQUMsTUFBTSxLQUFLLEdBQUcsRUFBRTtvQkFDcEIsSUFBSTt3QkFDQSxHQUFHLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFBO3FCQUMxQztvQkFBQyxPQUFPLENBQUMsRUFBRTt3QkFDUixPQUFPLE1BQU0sQ0FBQyxJQUFJLEtBQUssQ0FBQywrQ0FBK0MsQ0FBQyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQTtxQkFDdkY7aUJBQ0o7cUJBQU0sSUFBSSxHQUFHLENBQUMsWUFBWSxJQUFJLEdBQUcsQ0FBQyxZQUFZLENBQUMsTUFBTSxFQUFFO29CQUNwRCxHQUFHLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxZQUFZLENBQUE7aUJBQzlCO2dCQUVELE9BQU8sT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFBO2FBQ3RCO1FBQ0wsQ0FBQyxDQUFBO1FBRUQsR0FBRyxDQUFDLFNBQVMsR0FBRyxHQUFHLEVBQUU7WUFDakIsT0FBTyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsbUVBQW1FLENBQUMsQ0FBQyxDQUFBO1FBQ2pHLENBQUMsQ0FBQTtRQUVELElBQUk7WUFDQSxHQUFHLENBQUMsSUFBSSxDQUFDLE1BQU0sS0FBSyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQTtTQUNqRTtRQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ1IsT0FBTyxNQUFNLENBQUMsSUFBSSxLQUFLLENBQUMsa0NBQWtDLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDLENBQUE7U0FDMUU7SUFDTCxDQUFDLENBQUMsQ0FBQTtBQUNOLENBQUMsQ0FBQSJ9"]},"metadata":{},"sourceType":"script"}